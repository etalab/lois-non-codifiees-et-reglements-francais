# Article Annexe 1

1. Préambule

Le cahier des charges de la transmission, approuvé par arrêté du ministre du budget et de la réforme de l'Etat, constitue l'un des supports juridiques de la transmission des données et documents dématérialisés des collectivités territoriales et des établissements publics locaux au comptable public.

Le cadre juridique de la dématérialisation comprend en effet plusieurs composantes :

- le présent arrêté du 27 juin 2007 portant application de l'article D. 1617-23 du code général des collectivités territoriales et approuvant notamment le présent cahier des charges ;

- un formulaire d'adhésion devant être signé par l'ordonnateur de la collectivité territoriale ou de l'établissement public local souhaitant transmettre des données et documents électroniques respectant le protocole d'échange standard via un dispositif de transmission homologué. Ce formulaire est rappelé en annexe 2 du présent arrêté.

Le présent cahier des charges de la télétransmission énonce les conditions d'homologation des dispositifs de transmission proposés par un opérateur privé ou public, appelé responsable du dispositif de transmission.

Un dispositif homologué peut être mis en oeuvre par un ou plusieurs opérateurs, appelés tiers de transmission. La mise en oeuvre effective et le raccordement d'un dispositif de transmission homologué sont subordonnés à la signature préalable entre l'opérateur du dispositif (tiers de transmission) et la direction générale de la comptabilité publique d'une convention de raccordement respectant un modèle arrêté par cette dernière.

2. La dématérialisation avec l'application Hélios

2.1. La chaîne comptable et financière dans le SPL

La gestion comptable et financière des collectivités territoriales et des établissements publics locaux est l'une des missions fondamentales du réseau du Trésor public. Conformément au code général des collectivités territoriales, au code de la santé publique, à l'article 60 de la loi n° 63-156 du 23 février 1963 et au décret n° 62-1587 du 29 décembre 1962, les fonctions de comptable public de ces organismes publics locaux sont exercées par les comptables directs du Trésor.

Ces derniers, outre leur mission de comptable public, mettent leur expertise technique à la disposition des décideurs et des gestionnaires locaux.

En qualité de comptable public, le comptable direct du Trésor tient les comptes de la collectivité ou de l'établissement. Il est seul chargé du recouvrement de leurs recettes et du paiement de leurs dépenses, celles-ci étant justifiées selon les modalités fixées par l'annexe I visée à l'article D. 1617-19 du code général des collectivités territoriales.

Le comptable public rend compte chaque année de sa gestion en élaborant un compte de gestion ou un compte financier soumis au vote de l'assemblée délibérante de la collectivité ou de l'établissement puis au contrôle de la chambre régionale des comptes. Sa responsabilité personnelle et pécuniaire peut être engagée, le cas échéant, par le juge des comptes.

2.2. Le progiciel Hélios

L'application informatique Hélios des comptables directs du Trésor vise à améliorer le service rendu aux ordonnateurs locaux avec trois objectifs majeurs :

- unifier le système d'information dédié au secteur public local autour d'un coeur unique ;

- développer l'action du réseau du Trésor public grâce à une offre de services enrichie ;

- accompagner la modernisation de la gestion publique en proposant un haut degré de paramétrage permettant l'adaptation de l'outil aux évolutions à venir et en prenant en compte la dématérialisation des échanges d'informations avec les ordonnateurs.

Hélios a également pour objet d'améliorer le service rendu aux ordonnateurs locaux grâce à une gamme de prestations enrichies.

2.3. La dématérialisation avec Hélios et le PES

Sous l'impulsion du pôle national de dématérialisation de la direction générale de la comptabilité publique, une charte nationale partenariale pour la dématérialisation de la chaîne comptable et financière dans le secteur public local a été signée le 7 décembre 2004 par le directeur général de la comptabilité publique, les quatorze associations nationales représentatives des ordonnateurs locaux, les cinq administrations centrales de l'Etat concernées et les juridictions financières. La charte propose les principes généraux qui doivent présider à des actions cohérentes et coordonnées pour réussir la dématérialisation dans le secteur public local et, en particulier, le souhait de favoriser l'échange de données normalisées.

Elle est consultable sur internet à l'adresse électronique suivante :

http://www.colloc.minefi.gouv.fr/colootherfilesfina-loca/docs-divers/chartedemat.pdf

C'est sur la base des principes arrêtés par cette charte que les partenaires nationaux susvisés ont adopté une convention-cadre nationale le 16 décembre 2005. Cette dernière fixe les modalités de la dématérialisation des pièces justifiant les dépenses et les recettes des organismes publics locaux émises par les ordonnateurs locaux et transmises à leur comptable public au moyen du protocole d'échange standard d'Hélios (format XML).

Ce protocole, dans ses versions n° 2 et ultérieures, permet non seulement de dématérialiser les titres de recettes, les mandats de dépenses ainsi que les bordereaux récapitulant ces mandats et ces titres, mais aussi les pièces qui justifient ces pièces comptables, notamment les factures. Cependant, cette orientation, reposant sur un seul mode de dématérialisation et un seul vecteur de transmission pour l'ensemble des échanges à finalité comptable, est complétée par une définition des modalités de transmission de ce flux unique à valeur probante par le présent cahier des charges.

2.4. Le protocole PES et les signatures

Le protocole d'échange standard (PES) dans ses versions n° 2 et ultérieures autorise la transmission de deux signatures électroniques :

- la signature électronique dite "métier" des bordereaux de mandats de dépenses et des bordereaux de titres de recettes conférant un caractère probant à ces pièces comptables tant vis-à-vis du comptable public que de la chambre régionale des comptes ;

- la signature électronique dite "technique" ou de "transmission" des fichiers de données et de documents électroniques intitulés "PESAller".

Par souci de simplification, lorsque tous les bordereaux sont signés par la même personne faisant fonction d'ordonnateur, la signature globale du fichier par l'ordonnateur constituera une signature "métier" de l'ensemble des bordereaux.

Le PES permet aussi la communication de fichiers de signatures portant sur les pièces justificatives des mandats de dépenses et des titres de recettes. La génération des signatures est du ressort de chaque organisme public local émetteur des fichiers.

2.5. La transmission dans la chaîne de travail

La transmission ne constitue qu'une étape dans la chaîne de travail entre le système d'information de l'organisme public local et le progiciel Hélios du réseau du Trésor public qui permet d'identifier des étapes de production, de validation et de transmission des fichiers. Le processus peut être ainsi décomposé :

- la production du flux (fichier PESAller) par le progiciel financier de la collectivité territoriale ou de l'établissement public local ;

- la validation du flux par l'autorité compétente de la collectivité territoriale ou de l'établissement public local, le cas échéant ;

- la transmission sécurisée du flux via le dispositif de transmission choisi par la collectivité territoriale ou de l'établissement public local ;

- la validation technique du flux par Hélios et son intégration technique ;

- la production par Hélios d'un accusé de réception du flux qui est soit positif (intégration du flux dans Hélios), soit négatif (rejet du flux : PESAck, PESNack) ;

- la transmission sécurisée de l'accusé réception du flux par Hélios à son émetteur via le même dispositif de transmission qu'à l'aller ;

- la prise en compte par le progiciel financier de la collectivité territoriale ou de l'établissement public local de l'accusé de réception du flux (en vue de sa correction puis de sa réémission).

En fin de chaque exercice, l'ensemble de ces flux PES transmis par la collectivité territoriale ou de l'établissement public local sont intégrés au compte de gestion du comptable public communiqué au juge des comptes.

Ce processus est complété, suivant les souhaits exprimés par la collectivité territoriale ou l'établissement public local, par la transmission à ce dernier de flux dits retour, de manière asynchrone, donnant des informations sur les opérations comptables réalisées par le comptable public (paiements, encaissements,...) :

- la production du flux (PESRetour) par le progiciel Hélios ;

- la transmission sécurisée du flux via le dispositif de transmission choisi par la collectivité territoriale ou de l'établissement public local ;

- la validation technique du flux par le progiciel financier de la collectivité territoriale ou de l'établissement public local et son intégration.

Le présent cahier des charges ne concerne que la seule phase de transmission et ne concerne pas les phases de production et de validation qui pourront faire l'objet de procédure d'homologation qui leur seront propres.

2.6. Les dispositifs de transmission

Les collectivités territoriales et les établissements publics locaux peuvent transmettre des fichiers à Hélios à l'aide d'un dispositif de transmission homologué.

Par dispositif de transmission, on entend l'ensemble constitué par les outils (matériels et logiciels), ainsi que les documents décrivant les modalités de mise en oeuvre et d'exploitation de ces outils, permettant à une ou plusieurs collectivités de transmettre et de recevoir de façon dématérialisée des données et documents électroniques au format PES. Les outils situés en amont ou en aval de la transmission ne font pas partie du périmètre de la présente homologation et ne font pas l'objet d'exigence dans le présent cahier des charges.

Pour transmettre des données et documents électroniques au comptable public, chaque organisme public local doit recourir soit à la passerelle SSL de transmission d'Hélios, soit à un dispositif de transmission homologué conformément au présent cahier des charges. Il est libre de choisir le dispositif qui lui convient, disponible sur le marché, à la condition qu'il ait bien été préalablement homologué par la direction générale de la comptabilité publique.

L'homologation des dispositifs de transmission s'inscrit dans la logique d'interopérabilité entre administrations, un tiers de transmission pouvant offrir des dispositifs de transmission acceptés par plusieurs administrations de l'Etat. Par exemple, un même dispositif de télétransmission pourra être homologué par le ministère de l'intérieur et de l'aménagement du territoire (application ACTES) et par la direction générale de la comptabilité publique (application Hélios). Le dispositif de transmission peut être mis en oeuvre par un tiers de transmission (TdT). Le tiers de transmission peut être :

- une entreprise privée proposant son dispositif homologué de transmission aux collectivités et établissements publics locaux ;

- un organisme public local mutualisant la mise en oeuvre d'un dispositif homologué pour le compte de plusieurs collectivités territoriales ou établissements publics locaux ;

- une collectivité territoriale ou un établissement public local mettant en oeuvre un dispositif homologué spécifique pour son propre compte.

(Schéma non reproduit, consulter le fac-similé)

L'opérateur de transmission doit respecter les obligations suivantes :

Obligation n° 1-1 du tiers de transmission

Le dispositif de transmission homologué garantit la transmission sécurisée de flux électroniques entre les collectivités et le Trésor public, via le service d'échange d'Hélios. Il communique avec le service d'échange d'Hélios selon les modalités techniques ci-après :

(Schéma non reproduit, consulter le fac-similé)

2.7. Rôle des acteurs

La direction générale de la comptabilité publique met en place les infrastructures nécessaires à la réception et au stockage des données et documents électroniques reçus.

Elle met également à la disposition des collectivités territoriales et des établissements publics locaux la liste des dispositifs de transmission homologués à l'adresse électronique suivante :  http://www.colloc.minefi.gouv.fr/colostructfinaloca/comploca/demachai.html.

Elle fournit à l'opérateur de chaque dispositif de transmission les paramètres techniques de connexion au service d'échange d'Hélios.

Les personnels du réseau du Trésor public sont utilisateurs du progiciel Hélios, afin d'exercer leurs missions rappelées supra.

Les collectivités territoriales et les établissements publics locaux utilisent un dispositif de transmission homologué pour transmettre leurs données et documents électroniques, ces dispositifs pouvant être interfacés ou non avec leurs propres outils informatiques (progiciel financier, en particulier).

Le tiers de transmission (public ou privé) met en oeuvre un dispositif de transmission homologué et garantit le respect du présent cahier des charges et des dispositions de la convention de raccordement susvisée.

3. Les clauses de conformité au dispositif de transmission

Ce chapitre énonce l'ensemble des clauses dont le respect conditionne l'homologation de tout dispositif de transmission.

3.1. Architecture globale

Le dispositif de transmission doit respecter l'architecture globale définie dans le chapitre 2 du présent cahier des charges.

3.2. Normes pour les échanges de données

Le dispositif de transmission a vocation à envoyer à Hélios des données de prise en charge comptable sous forme électronique associées à des pièces justificatives également sous forme électronique conformément au protocole d'échange standard. La qualification de la production des fichiers dits "PESAller" fait l'objet d'un processus de qualification qui lui est propre et indépendant de la transmission.

3.3. Sécurisation des flux

3.3.1. Confidentialité des données

Le dispositif de transmission ne doit pas conduire à exploiter des données à caractère personnel détenues dans le cadre de la transmission. Si le dispositif utilise des données collectées dans le cadre de la transmission des données et documents électroniques, pour des usages ou des traitements ayant un objet autre que la seule transmission, et si ces données incluent des données nominatives personnelles, ces usages et traitements doivent faire l'objet d'une déclaration spécifique auprès de la CNIL conformément aux dispositions de la loi n° 78-17 du 6 janvier 1978 relative à l'informatique, aux fichiers et aux libertés. Cette obligation est rappelée dans la convention de raccordement signée par l'opérateur de transmission.

3.3.2. Authentification, intégrité

Le dispositif de transmission doit respecter les exigences de sécurisation décrites ci-après, qui ont pour objet, pour chaque flux de données et de documents électroniques, de permettre l'authentification de l'émetteur et de garantir l'intégrité des données transmises.

3.3.3. Protection contre les intrusions

Obligation n° 1-6 de l'opérateur

Le dispositif doit inclure des mécanismes assurant la détection et la prévention des attaques du réseau provenant des réseaux auxquels il est raccordé, en particulier de l'internet. Ces mécanismes devront être conformes à l'état de l'art en matière de prévention des intrusions. La documentation de mise en oeuvre et d'exploitation du dispositif doit prévoir que ces mécanismes feront l'objet de mises à jour régulières conformément aux prescriptions des éditeurs de ces mécanismes.

Le dispositif pourra en outre proposer de tenir à jour des fichiers techniques relatifs au suivi des transactions, permettant d'identifier les tentatives d'accès frauduleux, et l'usage des certificats révoqués par l'Autorité de certification.

3.4. Fonctionnalités

3.4.1. Emission des flux décrits

Obligation n° 1-7 de l'opérateur

Le dispositif doit permettre a minima l'émission et la réception des flux de données XML vers le service d'échange d'Hélios, selon le format du protocole d'échange standard PES (PES versions 1.5 et supérieures).

3.4.2. Traçabilité

Obligation n° 1-8 de l'opérateur

Le dispositif de transmission doit mettre à jour une liste des traces des fichiers échangés avec Hélios. Cette liste doit identifier intelligiblement la nature et les noms des fichiers de données échangés, les date et heure de transmission, la taille du fichier (octets), son empreinte SHA-1.

Elle doit pouvoir être exportable soit au format XML avec un élément XML correspondant à chaque fichier transmis, soit au format CSV avec une ligne pour chaque fichier transmis.

La convention de raccordement signée par l'opérateur du dispositif prévoit que cette liste doit pouvoir être fournie à la direction générale de la comptabilité publique ou à l'organisme public local à leur demande, et qu'elle fera l'objet d'un archivage sur une période minimale de huit années.

3.5. Modalités d'exploitation et gestion des incidents de fonctionnement

Une collectivité territoriale ou un établissement public local doit pouvoir transmettre à tout moment ses données et documents électroniques au moyen de son dispositif de transmission homologué. Néanmoins, en cas de nécessité due à la charge globale de transmission vers Hélios, le dispositif doit pouvoir limiter les flux de données à destination du service d'échange d'Hélios.

Obligation n° 1-9 de l'opérateur

Le dispositif de télétransmission doit comporter des fonctionnalités de contrôle de flux, permettant la limitation du volume des données transmis vers le service d'échange Hélios (en nombre de mégaoctets par heure).

Les conventions de raccordement, signées par les opérateurs des dispositifs de transmission, précisent que la direction générale de la comptabilité publique peut imposer à chaque opérateur de telles limitations, et que la mise en oeuvre de ces limitations doit être effective dans les quatre heures ouvrables suivant la demande.

Obligation n° 1-2 de l'opérateur

La documentation de mise en oeuvre et d'exploitation du dispositif doit préciser explicitement les modalités de prise en compte des demandes de limitation des flux de la DGCP.

Obligation n° 1-3 de l'opérateur

Le dispositif de télétransmission doit également être capable de stocker provisoirement des transmissions venant de collectivités territoriales et d'établissements publics locaux, afin de faire face à une limitation des flux ou à un arrêt provisoire, prévu ou non, du service d'échange d'Hélios.

Dans la convention de raccordement, l'opérateur s'engage à adapter sa capacité de stockage afin de pouvoir stocker des données transmises par les organismes publics locaux, sans les transmettre au service d'échange d'Hélios pendant deux jours ouvrés. Quel que soit l'état de disponibilité du service d'échange d'Hélios, les fonctionnalités du dispositif de transmission doivent rester accessibles à la collectivité territoriale ou à l'établissement public local.

Obligation n° 1-4 de l'opérateur

Le dispositif de télétransmission doit intégrer les mécanismes de relance automatique permettant de garantir l'acheminement des flux des organismes publics locaux à Hélios sans intervention complémentaire de ces derniers, même en cas d'indisponibilité du service d'échange d'Hélios.

La convention de raccordement prévoit qu'en cas d'incident de transmission de fichier vers Hélios l'opérateur du dispositif de transmission, avant de contacter la direction générale de la comptabilité publique afin de résoudre l'incident, effectue toutes les opérations de diagnostic interne sur le dispositif permettant d'identifier les causes, les conséquences et les voies de résolution.

4. Exigences techniques

Exigence n° 2-1

Les fichiers XML transmis au serveur d'échange DGCP sont compressés au format zip, afin de limiter la volumétrie échangée.

Exigence n° 2-2

Quand un dispositif effectue une transmission vers le service d'échange d'Hélios, il doit s'assurer que le fichier XML transmis respecte les règles de nommage précisé par le cahier des charges.

Exigence n° 2-3

Afin de transmettre et de recevoir les fichiers via le service d'échange d'Hélios, le dispositif homologué utilise les protocoles de transfert PESIT ou FTP au travers d'une interconnexion VPN Lan2Lan avec le réseau Rubis de la DGI/DGCP.

Exigence n° 2-4

Pour toute transmission du fichier au service d'échange d'Hélios, le dispositif homologué s'assure que la taille fichier transmis ne dépasse pas 100 Mo.

Exigence n° 2-5

Le dispositif est capable d'ouvrir et de maintenir une interconnexion VPN Lan2Lan IPSec avec le réseau de la direction générale de la comptabilité publique (spécifications détaillées fournies avec la convention de raccordement fournie par la DGCP). Les échanges de fichiers avec le service d'échange d'Hélios se font au moyen des protocoles FTP ou PESIT.

Exigence n° 2-6

Le dispositif devra s'authentifier, d'une part, au travers de la mise en oeuvre de l'interconnexion Lan2Lan, d'autre part, au travers des paramètres d'identification PESIT ou FTP.

Exigence n° 2-7

Le dispositif est capable de mettre en oeuvre l'interconnexion VPN Lan2Lan avec authentification par clé secrète ou certificat "serveur".

Exigence n° 2-8

Le dispositif est capable de communiquer en utilisant une adresse IP fixe publique, utilisée pour mettre en oeuvre à l'interconnexion Lan2Lan.

Exigence n° 2-9

Pour chaque transmission, le dispositif de télétransmission authentifie la collectivité ou l'établissement émetteur aux moyens de certificats présentés par les agents de l'organisme émetteur et/ou les infrastructures de l'émetteur.

Exigence n° 2-10

Le dispositif est capable d'accepter les transmissions d'information par des organismes publics locaux, s'authentifiant avec des certificats référencés par l'arrêté du 28 août 2006 pris en application du I de l'article 48 et de l'article 56 du code des marchés publics et relatif à la dématérialisation des procédures de passation des marchés publics formalisés. La liste de ces certificats est consultable à l'adresse électronique suivante sur internet :

http://www.entreprises.minefi.gouv.fr

Exigence n° 2-11

Lorsqu'une collectivité ou un établissement transmet des informations à destination d'Hélios, avant d'en effectuer le transfert effectif à Héros, le dispositif contrôle la validité du certificat d'authentification utilisé au regard de la liste de révocation mise à disposition par l'Autorité de certification.

Exigence n° 2-12

Lorsqu'une collectivité ou un établissement transmet des informations à destination d'Hélios, avant d'en effectuer le transfert effectif, le dispositif contrôle que le certificat présenté par la collectivité ou l'établissement appartient bien à une collectivité ou à un établissement (ou à un de ses agents) inscrit dans le référentiel mentionné ci-dessus.

Exigence n° 2-13

Pour les transmissions d'information en provenance des organismes publics locaux, le dispositif comprend des mécanismes garantissant que la confidentialité et l'intégrité des données de la collectivité ou de l'établissement au cours de la transmission. A titre de recommandation et conformément au Référentiel général d'interopérabilité, les protocoles suivants peuvent être utilisés :

TLS 1.0 et SSL 3.0, IPSEC.

Exigence n° 2-14

Dans le cas où PESIT est utilisé, le dispositif est capable de déposer le fichier dans un répertoire donné du serveur PESIT du service d'échange Hélios, en s'authentifiant avec identifiant et mot de passe et en utilisant les paramètres PESIT communiqués par la DGCP.

Exigence n° 2-15

Dans le cas où FTPs est utilisé, le dispositif est capable de déposer le fichier dans un répertoire donné du serveur FTPs du service d'échange d'Hélios, en s'authentifiant avec identifiant et mot de passe et en utilisant les paramètres FTP communiqués par la DGCP.

Exigence n° 2-16

La documentation de mise en oeuvre et d'exploitation du dispositif de transmission précise explicitement la prise en compte organisationnelle et technique des modalités, décrites ci-dessus, de gestion de l'adressage IP, clés privées et mots de passe, et les échanges avec le service d'échange d'Hélios sur le sujet.

Exigence n° 2-17

Le dispositif de télétransmission dispose d'un certificat serveur afin d'assurer l'authentification mutuelle par certificat avec les agents ou infrastructures des collectivités clientes. Ces certificats "serveur" devront être conformes aux exigences du RGS de la DGME.

Exigence n° 2-18

La documentation de mise en oeuvre et d'exploitation du dispositif précise les mesures de protection de la clé privée du certificat serveur du dispositif, qui devra être conforme au référentiel général de sécurité.

Exigence n° 2-19

La documentation de mise en oeuvre et d'exploitation du dispositif détaille les processus de mise à jour du paramétrage du dispositif permettant d'accepter, pour l'authentification des collectivités, uniquement les certificats conformes au référentiel général de sécurité.

Exigence n° 2-20

Le dispositif de transmission dispose d'un référentiel des collectivités et des établissements qui lui sont raccordés et autorisés à télétransmettre, identifiés par leur numéro SIREN/SIRET. Le référentiel inclut les certificats d'authentification utilisés par chaque collectivité ou établissement raccordé.

Exigence n° 2-21

La documentation de mise en oeuvre et d'exploitation du dispositif prévoit que les certificats présentés par les collectivités ou les établissements pour l'authentification sont valides (contrôle total de la chaîne de confiance et de la CRL).
